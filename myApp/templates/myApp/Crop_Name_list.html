{% extends 'myApp/_base.html' %}
{% load static %}

{% block content %}
  <script type="text/javascript" src="{% static 'DataTables/js/jquery.dataTables.min.js' %}"></script>
  <script type="text/javascript" src="{% static 'DataTables/js/dataTables.select.min.js' %}"></script>
  <link rel="stylesheet" type="text/css" href="{% static 'DataTables/css/jquery.dataTables.min.css' %}" media="screen">
  <link rel="stylesheet" type="text/css" href="{% static 'DataTables/css/select.dataTables.min.css' %}" media="screen">

  <div class="container" style="max-width: 540px;">
    <div class="card border-success col-12 my-2 py-0"
         style="max-width: 540px; color:#24535F ;background-color:#D9ECDC; border-width: 2px;">
      <div class="row">
        <div class="col-12">
          Local name of food item in {{ myCountry }}
          <table id="tbl_crops" class="table table-striped">
            <thead>
            <tr>
              <th>id</th>
              <th>Food group</th>
              <th>Food name</th>
            </tr>
            </thead>
            <tbody>
            {% for myCrop in mylist %}
              <tr>
                <td>{{ myCrop.id }}</td>
                <td>{{ myCrop.Food_grp }}</td>
                <td>{{ myCrop.Food_name }}</td>
              </tr>
            {% endfor %}
            </tbody>
            <div class="row">
              <div class="col-6">
                <span>
                  <a id="btn_add1" class="btn btn-block btn-info my-2 btn-sm" href="#">edit selected local name</a>
                </span>
              </div>
              <div class="col-6">
                <span>
                  <a id="btn_add2" class="btn btn-block btn-info my-2 btn-sm" href="#">add new local name</a>
                </span>
              </div>
            </div>
          </table>
        </div>
      </div>
    </div>
  </div>



  <script type="text/javascript">
    var id_selected_row = 0;
    $(document).ready(function () {
      myTbl = $('#tbl_crops').DataTable({
        "select": 'single',
        "columnDefs": [
          {
            targets: [
              1, 2
            ],
            visible: true
          }, {
            targets: '_all',
            bVisible: false
          }
        ],
        "initComplete": function (settings, json) {
          $('#btn_add1').click(function () {
            if (id_selected_row > 0) {
              var myURL = '/Crop_Name_Update/' + {{myCountry}} + '/' + id_selected_row + '/';
              $(location).attr('href', myURL);
            }
          });
          $('#btn_add2').click(function () {
            var myURL = '/Crop_Name_Create/' + {{ myCountry }} + '/';
            $(location).attr('href', myURL);
          });
          $('#tbl_crops tbody').on('click', 'tr', function () {
            id_selected_row = myTbl.row(this).data()[0];
          });
        }
      });
    });

  </script>
{% endblock %}
