{% extends 'myApp/_base.html' %}
{% load static %}
{% load humanize %}

{% block content %}
  <script type="text/javascript" src="{% static 'DataTables/js/jquery.dataTables.min.js' %}"></script>
  <script type="text/javascript" src="{% static 'DataTables/js/dataTables.select.min.js' %}"></script>
  <link rel="stylesheet" type="text/css" href="{% static 'DataTables/css/jquery.dataTables.min.css' %}" media="screen">
  <link rel="stylesheet" type="text/css" href="{% static 'DataTables/css/select.dataTables.min.css' %}" media="screen">

  <script type="text/javascript" src="{% static 'js/jquery.barrating.min.js' %}"></script>
  <link rel="stylesheet" href="{% static 'css/font-awesome.min.css' %}">
  <link rel="stylesheet" href="{% static 'css/fontawesome-apple.css' %}">
  <link rel="stylesheet" href="{% static 'css/bars-1to10.css' %}">


  <input type="hidden" value="" id="selected_row">

  <div class="container" style="max-width: 540px;">
    <div class="row">
      <div class="col-2 my-0 px-3">
        <img src="{% static 'img/no4.png' %}">
      </div>
      <div class="col-10 my-0 px-1">
        <h5>
          Diet planning for
          {{myLocation}}
        </h5>
      </div>
    </div>
  </div>

  <div class="container" style="max-width: 540px;">
    <div id="accordion">
      <div class="card  border-dark bg-light col-12 mt-2 py-0" style="max-width: 540px;">
        <div class="row">
          <div class="col-12">
            <div class="card-body py-0 px-0">
              <p class="card-text text-success my-0">
                myLocation:
                {{ myLocation }}
              </p>
              <p class="card-text my-0">
                country:
                {{ myLocation.myCountry.NAME_0 }}
              </p>
              <p class="card-text my-0">
                region:
                {{ myLocation.myCountry.NAME_1 }}
              </p>
              <p class="card-text my-0">
                province:
                {{ myLocation.myCountry.NAME_2 }}
              </p>
              <p class="card-text my-0">
                nutrition target:
                {{ myLocation.nutrition_target }}
              </p>
              <button class="btn btn-link" data-toggle="collapse" data-target="#more_info" aria-expanded="true" aria-controls="more_info">
                more info
              </button>

              <div id="more_info" class="collapse" aria-labelledby="heading{{crop.food_item_id}}" data-parent="#accordion">
                <p class="card-text my-0">
                  stunting rate:
                  {{ myLocation.stunting_rate }}
                </p>
                <p class="card-text my-0">
                  wasting rate:
                  {{ myLocation.wasting_rate }}
                </p>
                <p class="card-text my-0">
                  anemia rate:
                  {{ myLocation.anemia_rate }}
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>


  <div class="container border-secondary py-1 my-1 px-0" style="max-width: 540px; background-color:#F3F3F3;border-width: 2px;">
    <!-- 4個分のタブ -->
    <ul class="nav nav-tabs">
      <li class="nav-item">
        <a href="#tab1_link" class="nav-link active" id="tab1" data-toggle="tab">individual</a>
      </li>
      <li class="nav-item">
        <a href="#tab2_link" class="nav-link" id="tab2" data-toggle="tab">family</a>
      </li>
      <li class="nav-item">
        <a href="#tab3_link" class="nav-link" id="tab3" data-toggle="tab">community</a>
      </li>
    </ul>


    <!-- タブの移動先指定 -->
    <div class="tab-content">
      <div id="tab1_link" class="tab-pane active">
        {% include "./Diet_Sub1.html" %}
      </div>
      <div id="tab2_link" class="tab-pane">
        {% include "./Diet_Sub2.html" %}
      </div>
      <div id="tab3_link" class="tab-pane">
        {% include "./Diet_Sub3.html" %}
      </div>
    </div>
  </div>

  <!-- ダイアログ 読み込み -->
  {% include "./Diet_Modal.html" %}
  <!-- ---------------- -->

  <style media="screen">
    /* nav-item activeの文字色 */
    .nav-pills .show > .nav-link,
    .nav-tabs .nav-link.active {
      color: red;
      background-color: #87BFCD;
    }
  </style>


  <script>
    // グローバル変数の作成
    var myLocation = '';
    var myRoot = '';
    var jsonData = {{mylist_available|safe}};
    var target_en1 = {{dri_e1}};
    var target_pr1 = {{dri_p1}};
    var target_va1 = {{dri_v1}};
    var target_fe1 = {{dri_f1}};
    var target_en2 = {{dri_e2}};
    var target_pr2 = {{dri_p2}};
    var target_va2 = {{dri_v2}};
    var target_fe2 = {{dri_f2}};
    var target_en3 = {{dri_e3}};
    var target_pr3 = {{dri_p3}};
    var target_va3 = {{dri_v3}};
    var target_fe3 = {{dri_f3}};

    let url_tmp = window.location.href.split('/');
    let tmp1 = url_tmp[url_tmp.length - 2];
    url_tmp.pop();
    url_tmp.pop();
    url_tmp.pop();
    myRoot = url_tmp.join("/") + '/';
    myLocation = tmp1;
    ////////////////

    ////star rating/////
    $(function () {
      $('.rating_DRI').barrating({
        theme: 'bars-1to10',
        showSelectedRating:false,
        readonly:true
      }); // set barrating
      $('#mystar').barrating({
        theme: 'fontawesome-apple'
      });
    });

    ////////////////////////////////
    $('#lbl_target_en1').text(target_en1);
    $('#lbl_target_pr1').text(target_pr1);
    $('#lbl_target_va1').text(target_va1);
    $('#lbl_target_fe1').text(target_fe1);
    $('#lbl_target_en2').text(target_en2);
    $('#lbl_target_pr2').text(target_pr2);
    $('#lbl_target_va2').text(target_va2);
    $('#lbl_target_fe2').text(target_fe2);
    $('#lbl_target_en3').text(target_en3);
    $('#lbl_target_pr3').text(target_pr3);
    $('#lbl_target_va3').text(target_va3);
    $('#lbl_target_fe3').text(target_fe3);
    /////////////////////////////

  </script>


{% endblock %}
